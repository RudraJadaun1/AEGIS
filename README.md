# Project AEGIS: Air-Gapped Hardware Enclave
**No Radio. No Cloud. No Leaks.**  
A military-grade, fully offline hardware vault for storing and generating Time-based One-Time Passwords (TOTP).

> ![Assembled PCB](PLACEHOLDER_FOR_IMAGE)  
> *(Place a photo of your assembled PCB here)*

---

## About The Project
In an era of SIM-swapping, cloud breaches, and remote malware, software-based 2FA apps on connected smartphones are no longer enough for critical assets.

**Project AEGIS** (formerly Project Cerberus) is a dedicated hardware token designed with a **"Zero Trust"** philosophy.  
It has no Wi-Fi, no Bluetooth, and no USB data connection to the internet.  
It physically isolates your cryptographic secrets from the network, ensuring that your 2FA codes can only be generated by someone holding the physical device.

---

## Key Features
- **Air-Gapped Security:** Zero wireless connectivity. Attackers cannot hack what they cannot reach.  
- **Dual-Core Isolation:** Security operations run on a dedicated core, separate from the UI.  
- **Hardware Root of Trust:** TOTP secrets are stored inside two tamper-resistant cryptographic co-processors (ATECC608B), not in the microcontroller's flash memory.  
- **Precision Timekeeping:** Uses a high-accuracy MEMS RTC (DS3231MZ) to maintain time for years without syncing.  
- **Hardware Kill Switch:** A physical slide switch that disconnects the battery completely.  
- **OLED & Rotary Interface:** A crisp 128x64 display with a tactile dial for selecting accounts.  

---

## Hardware Architecture

The device is built around the **Seeed Studio XIAO ESP32-S3**, chosen for its dual-core power and compact footprint.  
The architecture is designed to minimize attack surfaces.

### 1. The Brain: XIAO ESP32-S3
- **Why:** Dual-core Xtensa LX7 processor running at 240MHz. Radios (Wi-Fi/BLE) disabled in firmware.  
- **Function:** Orchestrates user input, queries secure elements, drives display.  

### 2. The Vault: Dual ATECC608B Crypto Chips
- **Why:** Private keys stored in hardware-protected slots. Firmware dumps cannot extract TOTP seeds.  
- **Dual-Head Design:** Two chips on separate IÂ²C buses (Wire and Wire1) to avoid address conflicts and double storage capacity.  

### 3. The Clock: DS3231MZ RTC
- **Why:** TOTP requires precise timing. Standard MCUs drift seconds per day.  
- **Power:** Dedicated CR2032 coin cell keeps RTC running when main battery is dead.  

### 4. Power & Protection
- **Power Source:** 3.7V LiPo Battery (2500mAh) for months of usage.  
- **Monitoring:** Voltage divider allows OS to display battery voltage.  
- **Isolation:** SPDT slide switch cuts main power line for true "off" state.  

---

## Circuit Design
- Designed in **KiCad 8.0**, focusing on signal integrity and physical security.  

> ![Schematic](PLACEHOLDER_FOR_IMAGE)  
> *(Upload your final schematic screenshot here)*

### Key Circuit Details
- **Bus Isolation:** Crypto #1 shares "Noisy Bus" (D4/D5) with OLED and RTC; Crypto #2 on "Quiet Bus" (D0/D1) alone.  
- **Input Ladder:** 4 tactile buttons wired into a resistor ladder network to read all 4 via a single Analog Pin (D7).  
- **Noise Filtering:** Every IC has a 100nF decoupling capacitor next to its power pin.  

---

## PCB Layout
- **Front Layer (UI):** OLED, rotary encoder, tactile buttons.  
- **Back Layer (Security Core):** Crypto chips, RTC, battery connections.  
- **Aesthetics:** Matte black solder mask with ENIG finish. Back features custom "Enigma Rotor" graphic and Room 641A coordinates.  

> ![Routing Screenshot](PLACEHOLDER_FOR_IMAGE)  
> *(Upload the screenshot of complex routing lines here)*  

> ![3D Render](PLACEHOLDER_FOR_IMAGE)  
> *(Upload the 3D view of the board with the AEGIS logo)*  

---

## Firmware (Cerberus OS)
Custom firmware written in **C++ (Arduino framework)**, optimized for security and responsiveness.

### Code Structure
- **Secure Boot:** Initializes I2C buses and verifies crypto chips; halts if missing (tampering detected).  
- **Dual-Core Tasking:**  
  - Core 0: SHA1 hashing and secure element communication.  
  - Core 1: UI, animations, input polling for smooth dial operation.  
- **TOTP Engine:** Implements RFC 6238; reads RTC epoch, hashes with secret using HMAC-SHA1, truncates to 6-digit code.  

```cpp
// Snippet: Generating the HMAC Challenge
long timeStep = epoch / 30;
uint8_t challenge[8];
for (int i = 7; i >= 0; i--) {
    challenge[i] = timeStep & 0xFF;
    timeStep >>= 8;
}
// Challenge sent to ATECC608B for signing
